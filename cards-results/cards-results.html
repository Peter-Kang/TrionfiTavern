<cards-results>
  <style>
    .card-mat {
      margin-right: auto;
      margin-left: auto;
      width: 80%;
      height: auto;
      border-radius: 5px;
      background-color: rgba(255, 255, 255, 5%);
      padding: 10px;
      text-align: center;
    }
  </style>
  <div id="mat" class="card-mat" current-cards=""></div>
  <script tl-effect>
    function GetRandomCardNotOnList(mat) {
      //get current-cards into a array
      let cardsPicked = new Set(
        mat
          .getAttribute("current-cards")
          .trimStart()
          .split(" ")
          .map((x) => Math.abs(x))
      );
      //pick random index not on current-cards
      if (cardsPicked.size < cardSrcDefault.length) {
        let unpickedCards = cardSrcDefault
          .map((card, index) => index.toString())
          .filter((index) => {
            return !cardsPicked.has(Number(index));
          });
        const random_index = Math.floor(Math.random() * unpickedCards.length);
        //check if it is a flipped card
        const isFlipped = Math.floor(Math.random() * 10) == 0;
        const current = mat.getAttribute("current-cards");
        const just_picked_value = isFlipped
          ? unpickedCards[random_index] * -1
          : unpickedCards[random_index];
        mat.setAttribute(
          "current-cards",
          current + " " + just_picked_value.toString()
        );
        return [cardSrcDefault[unpickedCards[random_index]], isFlipped];
      }
      return null;
    }

    function addCard(mat) {
      const [src, isFlipped] = GetRandomCardNotOnList(mat);
      const card = createCard(src, isFlipped);
      if (card != null) {
        mat.appendChild(card);
      }
    }

    this.addEventListener("deck-draw", (event) => {
      const mat = document.getElementById("mat");
      addCard(mat);
    });
  </script>
</cards-results>
